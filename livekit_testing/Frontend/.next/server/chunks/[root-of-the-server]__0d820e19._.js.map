{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///home/paarth/voice_to_voice/livekit_testing/Frontend/app/api/connection-details/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { AccessToken, type AccessTokenOptions, type VideoGrant } from 'livekit-server-sdk';\n\n// NOTE: you are expected to define the following environment variables in `.env.local`:\nconst API_KEY = process.env.LIVEKIT_API_KEY;\nconst API_SECRET = process.env.LIVEKIT_API_SECRET;\nconst LIVEKIT_URL = process.env.LIVEKIT_URL;\n\n// don't cache the results\nexport const revalidate = 0;\n\nexport type ConnectionDetails = {\n  serverUrl: string;\n  roomName: string;\n  participantName: string;\n  participantToken: string;\n};\n\nexport async function GET() {\n  try {\n    if (LIVEKIT_URL === undefined) {\n      throw new Error('LIVEKIT_URL is not defined');\n    }\n    if (API_KEY === undefined) {\n      throw new Error('LIVEKIT_API_KEY is not defined');\n    }\n    if (API_SECRET === undefined) {\n      throw new Error('LIVEKIT_API_SECRET is not defined');\n    }\n\n    // Generate participant token\n    const participantName = 'user';\n    const participantIdentity = `voice_assistant_user_${Math.floor(Math.random() * 10_000)}`;\n    const roomName = `voice_assistant_room_${Math.floor(Math.random() * 10_000)}`;\n    const participantToken = await createParticipantToken(\n      { identity: participantIdentity, name: participantName },\n      roomName\n    );\n\n    // Return connection details\n    const data: ConnectionDetails = {\n      serverUrl: LIVEKIT_URL,\n      roomName,\n      participantToken: participantToken,\n      participantName,\n    };\n    const headers = new Headers({\n      'Cache-Control': 'no-store',\n    });\n    return NextResponse.json(data, { headers });\n  } catch (error) {\n    if (error instanceof Error) {\n      console.error(error);\n      return new NextResponse(error.message, { status: 500 });\n    }\n  }\n}\n\nfunction createParticipantToken(userInfo: AccessTokenOptions, roomName: string) {\n  const at = new AccessToken(API_KEY, API_SECRET, {\n    ...userInfo,\n    ttl: '15m',\n  });\n  const grant: VideoGrant = {\n    room: roomName,\n    roomJoin: true,\n    canPublish: true,\n    canPublishData: true,\n    canSubscribe: true,\n  };\n  at.addGrant(grant);\n  return at.toJwt();\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEA,wFAAwF;AACxF,MAAM,UAAU,QAAQ,GAAG,CAAC,eAAe;AAC3C,MAAM,aAAa,QAAQ,GAAG,CAAC,kBAAkB;AACjD,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAGpC,MAAM,aAAa;AASnB,eAAe;IACpB,IAAI;QACF,IAAI,gBAAgB,WAAW;YAC7B,MAAM,IAAI,MAAM;QAClB;QACA,IAAI,YAAY,WAAW;YACzB,MAAM,IAAI,MAAM;QAClB;QACA,IAAI,eAAe,WAAW;YAC5B,MAAM,IAAI,MAAM;QAClB;QAEA,6BAA6B;QAC7B,MAAM,kBAAkB;QACxB,MAAM,sBAAsB,CAAC,qBAAqB,EAAE,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,SAAS;QACxF,MAAM,WAAW,CAAC,qBAAqB,EAAE,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,SAAS;QAC7E,MAAM,mBAAmB,MAAM,uBAC7B;YAAE,UAAU;YAAqB,MAAM;QAAgB,GACvD;QAGF,4BAA4B;QAC5B,MAAM,OAA0B;YAC9B,WAAW;YACX;YACA,kBAAkB;YAClB;QACF;QACA,MAAM,UAAU,IAAI,QAAQ;YAC1B,iBAAiB;QACnB;QACA,OAAO,+PAAA,CAAA,eAAY,CAAC,IAAI,CAAC,MAAM;YAAE;QAAQ;IAC3C,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,OAAO;YAC1B,QAAQ,KAAK,CAAC;YACd,OAAO,IAAI,+PAAA,CAAA,eAAY,CAAC,MAAM,OAAO,EAAE;gBAAE,QAAQ;YAAI;QACvD;IACF;AACF;AAEA,SAAS,uBAAuB,QAA4B,EAAE,QAAgB;IAC5E,MAAM,KAAK,IAAI,uOAAA,CAAA,cAAW,CAAC,SAAS,YAAY;QAC9C,GAAG,QAAQ;QACX,KAAK;IACP;IACA,MAAM,QAAoB;QACxB,MAAM;QACN,UAAU;QACV,YAAY;QACZ,gBAAgB;QAChB,cAAc;IAChB;IACA,GAAG,QAAQ,CAAC;IACZ,OAAO,GAAG,KAAK;AACjB","debugId":null}}]
}